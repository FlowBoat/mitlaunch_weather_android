package io.github.flowboat.flowweather.data.bridge

import io.github.flowboat.flowweather.data.bridge.report.ReportGenerator
import org.junit.Assert
import org.junit.Test

class PacketParserTest {
    @Test
    fun parse() {
        val data = arrayOf(
                0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF,
                0x00, 0x01,
                0xA3, 0xC1, 0x35, 0xAD,
                0x00, 0x00, 0x00, 0x00, 0x5A, 0x33, 0x18, 0x46,
                0x00, 0x00,
                0x00, 0x00, 0x00, 0x01,
                0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF,
                0x00, 0x01,
                0xA3, 0xC1, 0x35, 0xAD,
                0x00, 0x00, 0x00, 0x00, 0x5A, 0x33, 0x18, 0x46,
                0x00, 0x00,
                0x00, 0x00, 0x00, 0x01,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0x00, 0x00, 0x00, 0x00, 0x5A, 0x33, 0x18, 0x46,
                0xA0, 0x4C,
                0xEE, 0x21,
                0x89, 0x92,
                0x03, 0x01,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0x00, 0x00, 0x00, 0x00, 0x5A, 0x33, 0x18, 0x46,
                0xA0, 0x4C,
                0xEE, 0x21,
                0x89, 0x92,
                0x03, 0x01
        ).packBytes()
        
        val result = PacketParser().parse(data)
        val report = ReportGenerator().gen(System.currentTimeMillis(), result)
        Assert.assertEquals(4, result.size)
    }
    
}